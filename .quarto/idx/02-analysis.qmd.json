{"title":"Analysis","markdown":{"yaml":{"title":"Analysis"},"headingText":"Setting up","containsRefs":false,"markdown":"\n\nGoals of this analysis: \n\n- Compare the 31 states and the entity of Mexico City in terms of the climate change index, water insecurity, groundwater access and reforestation efforts in a line chart to visualize the data. \n- How does each state rank in each of the categories? Which are the best and worst states?  \n \n\n\n```{r}\nlibrary(tidyverse)\nlibrary(janitor)\nlibrary(rvest)\nlibrary(httr2)\nlibrary(clipr)\n```\n\n\n## Importing the cleaned data \n\nHere I am importing the data from my cleaning notebook so that I can start my analysis. \n\n```{r}\nall_the_data <- read_rds(\"data-processed/01-finaldata.rds\")\n\n\nall_the_data |> glimpse()\n```\n\n\n\n## Climate change index \n\nTo look at how the different states perform per year, I want to create a line chart for the climate change index score. \n\nHere we will prepare the data to isolate the climate change index: \n\n```{r}\nclimate_change_index <- all_the_data |>\n  filter(source == \"climate\") |>\n  group_by(unidad_geografica_str, ano) |>\n  select(unidad_geografica_str, valor, ano) |> \n  mutate(ano= str_c(\"01-01-\", ano) |> mdy() ) |> \n    filter(unidad_geografica_str != \"Nacional\") \n\n  \n\nclimate_change_index\n```\n\nHere I am preparing the data by making a vector: \n\n```{r}\nclimate_change_list <- all_the_data |> distinct(unidad_geografica_str) |> pull(unidad_geografica_str) \n\n\nclimate_change_list\n```\n\n\nNow we will plot using a function for each of the Mexican states: \n\n```{r}\nplot_climate <- function(plot_state) {\n  climate_change_index |> \n  filter(unidad_geografica_str == plot_state, unidad_geografica_str != \"Nacional\") |>\n  ggplot(aes(x = ano, y = valor, color = unidad_geografica_str)) +\n  geom_point() + \n  geom_line() +\n  labs(title = str_glue(\"Climate change index for all Mexican states: \", plot_state|> str_to_title()), x= \"year\", y= \"Value\", color = \"State\", subtitle = str_wrap(\"The climate change index measures the performance of each state when it comes to good use of natural resoures. In most recent years, most states have seen a decrease in scores.\"), caption = \"Source = Consejo Nuevo León\") \n}\n\n## This is an example to make sure that it works: \nplot_climate(climate_change_list[[1]])\n```\n\n\nNow we will map the function to plot all of the states: \n\n```{r}\nclimate_change_list |> \n  map(plot_climate) \n\n```\n\nI noticed a trend with a significant drop in scores throughout many charts in the year 2018. \n\nI'm going to plot all of the states together to observe this: \n\n```{r}\nclimate_joint_chart <- climate_change_index |> \n  ggplot(aes(x = ano, y = valor, color = unidad_geografica_str)) +\n  geom_point() + \n  geom_line() +\n labs(title = \"Climate change index for all Mexican states\", subtitle= str_wrap(\"The climate change index score of most Mexican states dropped significantly in 2018, the year current President Andres Manuel Lopez Obrador came into power.\"), x = \"Year\", y = \"Value\", color = \"State\", caption = \"Source = Consejo Nuevo León\"\n) +\n  theme(legend.position = \"bottom\")\n\n\n ggsave(\"figures/climate_joint_chart.png\")\n```\n\n\n![](figures/climate_joint_chart.png) \n\nNote: \"Nacional,\" which represents all of the states combined, has no data. \n\nData takeaways: The overall climate change index levels have decreased in recent years. The entity of Mexico City was consistently scored the highest since 2011, while the state of Quintana Roo stays closer to the bottom of the ranking with a low score of 13.143 in 2022. Meanwhile, the states of Hidalgo and Oaxaca improved significantly during the pandemic years. \n\nThe decrease in score began some time before the pandemic, around 2018. Interestingly enough, President Andres Manuel Lopez Obrador came into office in Dec. 2018. More exploration and reporting would be needed to explain if there is a relationship between the lower scores and this event. \n\n\n## Water insecurity \n\nNow I want to compare the percentage of homes that the Household Water Insecurity Experiences-HWISE qualifies as going through drinking water insecurity. This data focuses on data just from 2021 to 2022. \n\nThis particular data set also includes \"Nacional\" which represents the average percentage of homes dealing with water insecurity in the entire country. \n\nHere I am preparing the data: \n\n```{r}\nwater_insecurity_percent <- all_the_data |>\n  filter(source == \"water_insecurity\") |>\n  group_by(unidad_geografica_str, ano) |>\n  select(unidad_geografica_str, valor, ano) |>\n  mutate(ano= str_c(\"01-01-\", ano) |> mdy() )\n\n\nwater_insecurity_percent\n```\n\n\nI am going to visualise the data with a vector: \n\n```{r}\nwater_insecurity_list <- all_the_data |> distinct(unidad_geografica_str) |> pull(unidad_geografica_str)\n\nwater_insecurity_list\n```\n\nNow I am plotting the data for each Mexican state with a function: \n\n```{r}\nplot_water_insecurity <- function(plot_state) {\n  water_insecurity_percent |> \n  filter(unidad_geografica_str == plot_state) |>\n  ggplot(aes(x = ano, y = valor, color = unidad_geografica_str)) +\n  geom_point() + \n  geom_col() +\n  labs(title = str_glue(\"Percentage of water insecurity in all 32 Mexican states: \", plot_state|> str_to_title()), x= \"Year\", y= \"Value\", color = \"State\", subtitle = str_wrap(\"The state of Nuevo León had a drastic increase in homes experiencing water insecurity, with almost half of homes not having enough access to water in 2022.\"), caption = \"Source = Consejo Nuevo León\"\n)\n}\n\n## This is an example to make sure that it works: \nplot_water_insecurity(water_insecurity_list[[1]])\n```\n\n\nNow I will list out the rest of the Mexican states: \n\n```{r}\nwater_insecurity_list |> \n  map(plot_water_insecurity)\n```\n\nData takeaways:  The state of Nuevo León saw a drastic increase in homes experiencing water insecurity from 2021 to 2022. The percentage of homes increased from 7.004% to 42.014% or almost half of the population. Meanwhile, in the state of Tabasco, the percentage of homes dealing with water insecurity dropped from 38.690% to 10.830%.\n\n\n## Groundwater \n\nNow I will look at the volume of available groundwater that can be used by each population in a way that will not hurt the environment. \n\nThe data for this variable only accounts for information from 2018 and 2020. \n\nHere I prepared the data: \n\n```{r}\ngroundwater_volume <- all_the_data |>\n  filter(source == \"groundwater\") |>\n  group_by(unidad_geografica_str, ano) |>\n  select(unidad_geografica_str, valor, ano) |>\n  mutate(ano= str_c(\"01-01-\", ano) |> mdy() )\n\n\ngroundwater_volume\n```\n\nNow I will visualize the data by building a function specific to ground water data: \n\n```{r}\ngroundwater_list <- all_the_data |> distinct(unidad_geografica_str) |> pull(unidad_geografica_str)\n\ngroundwater_list\n```\n\nNow I will plot the data for each state: \n\n```{r}\nplot_groundwater <- function(plot_state) {\n  groundwater_volume |> \n  filter(unidad_geografica_str == plot_state) |>\n  ggplot(aes(x = ano, y = valor, color = unidad_geografica_str)) +\n  geom_point() + \n  geom_col() +\n  labs(title = str_glue(\"Volume of available groundwater in each Mexican state: \", plot_state|> str_to_title()), x= \"Year\", y= \"Value\", color = \"State\", subtitle = str_wrap(\"Many states like Nuevo León are experiencing an increasing deficit of groundwater availablility.\"), caption = \"Source = Consejo Nuevo León\"\n)\n}\n\n## This is an example to make sure that it works: \nplot_groundwater(groundwater_list[[1]])\n```\n\nNow I will plot each state: \n\n```{r}\ngroundwater_list |> \n  map(plot_groundwater)\n```\n\n\nData takeaways: The availability of groundwater in 2018 decreased from -131.490 to -294.150 millions of cubic meters of groundwater, meaning that there is an increase in the deficit volume of groundwater in this state. Nuevo León went through an intense drought in 2022, whose data is not included. \n\n## Reforestation \n\nLastly, I will add the data for the hectares of reforestation done by each state. This data also includes \"Nacional\" or the amount of hectares reforested in the entire nation by year. \n\nI prepare the data: \n\n```{r}\nreforestation_hectares <- all_the_data |>\n  filter(source == \"reforestation\") |>\n  group_by(unidad_geografica_str, ano) |>\n  select(unidad_geografica_str, valor, ano) |>\n  mutate(ano= str_c(\"01-01-\", ano) |> mdy() )\n\nreforestation_hectares\n```\n\nNow I will do my last iteration with this data: \n\n```{r}\nreforestation_list <- all_the_data |> distinct(unidad_geografica_str) |> pull(unidad_geografica_str)\n\nreforestation_list\n```\n\nNow I plot the data with a function: \n\n```{r}\nplot_reforestation <- function(plot_state) {\n  reforestation_hectares |> \n  filter(unidad_geografica_str == plot_state) |>\n  ggplot(aes(x = ano, y = valor, color = unidad_geografica_str)) +\n  geom_point() + \n  geom_line() +\n  labs(title = str_glue(\"Hectares reforested in each Mexican state: \", plot_state|> str_to_title()), x= \"Year\", y= \"Value\", color = \"State\", subtitle = str_wrap(\"At the national level, the most amount of hectares reforested was 375,705.790 in 2012.\"), caption = \"Source = Consejo Nuevo León\"\n)\n}\n\n## This is an example to make sure that it works: \nplot_reforestation(reforestation_list[[1]])\n```\n\nNow I will plot each state: \n\n```{r}\nreforestation_list |> \n  map(plot_reforestation)\n```\n\n\nData takeaway: The national amount of hectares reforested is not surprisingly the entity with the highest amount of hectares. The peak of reforestation happened in 2012, with 375,705.790 hectares reforested in 2012. In 2020, the total amount of hectares reforested dropped to a stunning 4,618.38. \n\n\n\n## Comparing all 32 state rankings \n\nHere I will use a ranking to determine how well each state performed in each category. \n\nStarting with the ranking for the climate change index: \n\n```{r}\n\nclimate_rank <- climate_change_index |>\n  group_by(ano) |>\n  ## Group by year so I could see the ranking by year \n  mutate(ranking = dense_rank(desc(valor))) |>\n## Then created the rank variable in descending order because a higher score is a better score. \n arrange(desc(valor)) |> \n## I wanted to visualize the highest to lowest scores all together \n  add_column(source = \"Climate\")\nclimate_rank\n```\n\nI am using a column graph to show the ranking distribution of each state per year: \n\n```{r}\n climate_rank_chart <- climate_rank |>\n  ggplot(aes(fill = ranking, x= ano |> year() |> as.character(), y= unidad_geografica_str)) +\n  geom_tile() + \n  geom_text(aes(label = ranking), color = \"white\")+\n  labs(\n    x = \"Year\",\n    y = \"State\",\n    title = \"Climate change index ranking by year for each Mexican state\",\n    color = \"Ranking\", \n    subtitle = str_wrap(\"Ciudad de México constantly had the highest ranking for climate change index score. Notably, Mexico City has the highest population density of the country.\"), \n  caption = \"Source = Consejo Nuevo León\"\n  ) +\ntheme(legend.position = \"bottom\")\n\n\n ggsave(\"figures/climate_rank_chart.png\")\n```\n\nNow we print our ranking chart so it looks good on the computer: \n\n![](figures/climate_rank_chart.png)\n\nData takeaway: Ranking each of the 32 federal entities from 1 to 32, we can show that a higher ranking which is associated with a better score performance is represented with a darker blue shade. Aguascalientes and Ciudad de México consistently have a higher ranking per year, while states like Tabasco and Chiapas consistently ranked lower. Ciudad de México is a large urban area, where the data might observe less natural resources. \n\n\nNow I want to look at the water insecurity percentage data and rank each states performance: \n\n```{r}\nwater_insecurity_rank <- water_insecurity_percent |>\n  group_by(ano) |>\n  ## Group by year so I could see the ranking by year \n  mutate(ranking = dense_rank(valor)) |>\n## Then created the rank variable in descending order because a higher score is a better score. \n arrange(valor) |>\n## I wanted to visualize the highest to lowest scores all together \n  add_column(source = \"Water insecurity\")\n\n\nwater_insecurity_rank\n```\n\nNow I want to visualize the ranking: \n\n```{r}\nwater_insecurity_chart <- water_insecurity_rank |>\n  ggplot(aes(fill = ranking, x= ano |> year() |> as.character(), y= unidad_geografica_str)) +\n  geom_tile() +\n  geom_text(aes(label = ranking), color = \"white\") +\n  labs(\n    x = \"Year\",\n    y = \"State\",\n    title = \"Water insecurity performance ranking by year for each Mexican state\",\n    color = \"Ranking\",\n    subtitle = str_wrap(\"Nuevo León had 7.004% of homes with not enough available water in 2021, ranking in fifth place compared to other states. In 2022, the state ranked in last place with 42.014% of homes experiencing water insecurity in 2022.\"), \n    caption = \"Source = Consejo Nuevo León\"\n  ) +\ntheme(legend.position = \"bottom\")\n\n\n ggsave(\"figures/water_insecurity_chart.png\")\n```\n\n![](figures/water_insecurity_chart.png)\n\n\nGroundwater ranking for the states with the most amount of groundwater is represented with this data: \n\n```{r}\ngroundwater_rank <- groundwater_volume |>\n  group_by(ano) |>\n  ## Group by year so I could see the ranking by year \n  mutate(ranking = dense_rank(desc(valor))) |>\n## Then created the rank variable in descending order because a higher score is a better score. \n arrange(desc(valor)) |> \n## I wanted to visualize the highest to lowest scores all together \n   add_column(source = \"Groundwater\")\n \n\ngroundwater_rank\n```\n\n\nNow we will visualize the groundwater ranking: \n\n```{r}\ngroundwater_chart <- groundwater_rank |>\n  ggplot(aes(fill = ranking, x= ano |> year() |> as.character(), y= unidad_geografica_str)) +\n  geom_tile() +\n  geom_text(aes(label = ranking), color= \"white\") +\n  labs(\n    x = \"Year\",\n    y = \"State\",\n    title = \"Amount of available groundwater volume for each Mexican state\",\n    color = \"Ranking\", \n    subtitle = str_wrap(\"Nuevo León has a significant deficit of groundwater availablility, with -294.150 millions of cubic meters of groundwater.\"), \n    caption = \"Source = Consejo Nuevo León\"\n  ) +\ntheme(legend.position = \"bottom\")\n\n\n ggsave(\"figures/groundwater_chart.png\") \n```\n\n\n![](figures/groundwater_chart.png)\n\nFinally, lets look at the ranking for reforestation efforts in each state: \n\n```{r}\nreforestation_rank <- reforestation_hectares |> \n  filter(unidad_geografica_str != \"Nacional\") |>\n  group_by(ano) |>\n  ## Group by year so I could see the ranking by year \n  mutate(ranking = dense_rank(desc(valor))) |>\n## Then created the rank variable in descending order because a higher score is a better score. \n arrange(desc(valor)) |> \n## I wanted to visualize the highest to lowest scores all together \n  add_column(source = \"Reforestation\")\n\n\nreforestation_rank\n```\n\n\nNow I will visualize the data using ggplot: \n\n```{r}\nreforestation_chart <- reforestation_rank |>\n  ggplot(aes(fill = ranking, x= ano |> year() |> as.character(), y= unidad_geografica_str)) +\n  geom_tile() +\n  geom_text(aes(label = ranking), color = \"white\") + \n  labs(\n    x = \"Year\",\n    y = \"State\",\n    title = \"Hectares reforested in each Mexican state\",\n    color = \"Ranking\", \n    subtitle = str_wrap(\"Hectares of reforested areas in each state vary consistently. The year 2012 had a significant increase in reforested areas, with states like San Luis Potosi and Coahuila leading in rank.\"), \n   caption = \"Source = Consejo Nuevo León\"\n  ) +\ntheme(legend.position = \"bottom\")\n\n\n ggsave(\"figures/reforestation_chart.png\") \n```\n\n![](figures/reforestation_chart.png)\n\n## Nuevo León ranking \n\nIn order to see how my home state of Nuevo León did in all of the categories I have to put the ranking data together: \n\nI will combine the ranking using bind.rows: \n\n\n```{r}\nnuevo_leon_ranking <- \nbind_rows(climate_rank, water_insecurity_rank, groundwater_rank, reforestation_rank) |> \n  filter(unidad_geografica_str == \"Nuevo León\")\n\nnuevo_leon_ranking\n## We added the source column in each ranking break down \n```\n\n\nVisualize the ranking for Nuevo León: \n\n```{r}\nnuevo_leon_ranking  |>\n  ggplot(aes(fill = ranking, x= ano |> year() |> as.character(), y= source)) +\n   geom_tile()+\n   geom_text(aes(label = ranking), color = \"white\") +\n  labs(\n    x = \"Year\",\n    y = \"Category\",\n    title = \"Nuevo León ranking in all four categories\",\n    color = \"Ranking\", \n    subtitle = str_wrap(\"Each tile represents the ranking position of the state of Nuevo León for the four different categories: climate change index, water insecurity, groundwater and reforestation. Even though Nuevo León placed 33rd in 2022 for water insecurity, which is the lowest ranking position, the state ranked fourth in the same year for climate change index.\"), \n    caption = \"Source = Consejo Nuevo León\"\n  ) +\ntheme(legend.position = \"bottom\")\n\n\n ggsave(\"figures/nuevo_leon_ranking.png\") \n```\n\n![](figures/nuevo_leon_ranking.png)\n\n\nData takeaways: Each tile represents the ranking position of the state of Nuevo León for the four different categories: climate change index, water insecurity, groundwater and reforestation. Even though Nuevo León placed thirty third in 2022 for water insecurity (including the ranking for the whole nation plus 32 federal entities), which is the lowest ranking, the state ranked fourth in the same year for climate change index, or how well the state uses its natural resources. Extra reporting and investigation would be needed to asses these contrasting results.  \n\nFor the category of reforestation, Nuevo León has significantly improved when compared to other states. In 1993, Nuevo León occupied 16th place, but moved up to fourth in 2022. \n\n\n\n\n\n\n\n","srcMarkdownNoYaml":"\n\nGoals of this analysis: \n\n- Compare the 31 states and the entity of Mexico City in terms of the climate change index, water insecurity, groundwater access and reforestation efforts in a line chart to visualize the data. \n- How does each state rank in each of the categories? Which are the best and worst states?  \n \n\n## Setting up \n\n```{r}\nlibrary(tidyverse)\nlibrary(janitor)\nlibrary(rvest)\nlibrary(httr2)\nlibrary(clipr)\n```\n\n\n## Importing the cleaned data \n\nHere I am importing the data from my cleaning notebook so that I can start my analysis. \n\n```{r}\nall_the_data <- read_rds(\"data-processed/01-finaldata.rds\")\n\n\nall_the_data |> glimpse()\n```\n\n\n\n## Climate change index \n\nTo look at how the different states perform per year, I want to create a line chart for the climate change index score. \n\nHere we will prepare the data to isolate the climate change index: \n\n```{r}\nclimate_change_index <- all_the_data |>\n  filter(source == \"climate\") |>\n  group_by(unidad_geografica_str, ano) |>\n  select(unidad_geografica_str, valor, ano) |> \n  mutate(ano= str_c(\"01-01-\", ano) |> mdy() ) |> \n    filter(unidad_geografica_str != \"Nacional\") \n\n  \n\nclimate_change_index\n```\n\nHere I am preparing the data by making a vector: \n\n```{r}\nclimate_change_list <- all_the_data |> distinct(unidad_geografica_str) |> pull(unidad_geografica_str) \n\n\nclimate_change_list\n```\n\n\nNow we will plot using a function for each of the Mexican states: \n\n```{r}\nplot_climate <- function(plot_state) {\n  climate_change_index |> \n  filter(unidad_geografica_str == plot_state, unidad_geografica_str != \"Nacional\") |>\n  ggplot(aes(x = ano, y = valor, color = unidad_geografica_str)) +\n  geom_point() + \n  geom_line() +\n  labs(title = str_glue(\"Climate change index for all Mexican states: \", plot_state|> str_to_title()), x= \"year\", y= \"Value\", color = \"State\", subtitle = str_wrap(\"The climate change index measures the performance of each state when it comes to good use of natural resoures. In most recent years, most states have seen a decrease in scores.\"), caption = \"Source = Consejo Nuevo León\") \n}\n\n## This is an example to make sure that it works: \nplot_climate(climate_change_list[[1]])\n```\n\n\nNow we will map the function to plot all of the states: \n\n```{r}\nclimate_change_list |> \n  map(plot_climate) \n\n```\n\nI noticed a trend with a significant drop in scores throughout many charts in the year 2018. \n\nI'm going to plot all of the states together to observe this: \n\n```{r}\nclimate_joint_chart <- climate_change_index |> \n  ggplot(aes(x = ano, y = valor, color = unidad_geografica_str)) +\n  geom_point() + \n  geom_line() +\n labs(title = \"Climate change index for all Mexican states\", subtitle= str_wrap(\"The climate change index score of most Mexican states dropped significantly in 2018, the year current President Andres Manuel Lopez Obrador came into power.\"), x = \"Year\", y = \"Value\", color = \"State\", caption = \"Source = Consejo Nuevo León\"\n) +\n  theme(legend.position = \"bottom\")\n\n\n ggsave(\"figures/climate_joint_chart.png\")\n```\n\n\n![](figures/climate_joint_chart.png) \n\nNote: \"Nacional,\" which represents all of the states combined, has no data. \n\nData takeaways: The overall climate change index levels have decreased in recent years. The entity of Mexico City was consistently scored the highest since 2011, while the state of Quintana Roo stays closer to the bottom of the ranking with a low score of 13.143 in 2022. Meanwhile, the states of Hidalgo and Oaxaca improved significantly during the pandemic years. \n\nThe decrease in score began some time before the pandemic, around 2018. Interestingly enough, President Andres Manuel Lopez Obrador came into office in Dec. 2018. More exploration and reporting would be needed to explain if there is a relationship between the lower scores and this event. \n\n\n## Water insecurity \n\nNow I want to compare the percentage of homes that the Household Water Insecurity Experiences-HWISE qualifies as going through drinking water insecurity. This data focuses on data just from 2021 to 2022. \n\nThis particular data set also includes \"Nacional\" which represents the average percentage of homes dealing with water insecurity in the entire country. \n\nHere I am preparing the data: \n\n```{r}\nwater_insecurity_percent <- all_the_data |>\n  filter(source == \"water_insecurity\") |>\n  group_by(unidad_geografica_str, ano) |>\n  select(unidad_geografica_str, valor, ano) |>\n  mutate(ano= str_c(\"01-01-\", ano) |> mdy() )\n\n\nwater_insecurity_percent\n```\n\n\nI am going to visualise the data with a vector: \n\n```{r}\nwater_insecurity_list <- all_the_data |> distinct(unidad_geografica_str) |> pull(unidad_geografica_str)\n\nwater_insecurity_list\n```\n\nNow I am plotting the data for each Mexican state with a function: \n\n```{r}\nplot_water_insecurity <- function(plot_state) {\n  water_insecurity_percent |> \n  filter(unidad_geografica_str == plot_state) |>\n  ggplot(aes(x = ano, y = valor, color = unidad_geografica_str)) +\n  geom_point() + \n  geom_col() +\n  labs(title = str_glue(\"Percentage of water insecurity in all 32 Mexican states: \", plot_state|> str_to_title()), x= \"Year\", y= \"Value\", color = \"State\", subtitle = str_wrap(\"The state of Nuevo León had a drastic increase in homes experiencing water insecurity, with almost half of homes not having enough access to water in 2022.\"), caption = \"Source = Consejo Nuevo León\"\n)\n}\n\n## This is an example to make sure that it works: \nplot_water_insecurity(water_insecurity_list[[1]])\n```\n\n\nNow I will list out the rest of the Mexican states: \n\n```{r}\nwater_insecurity_list |> \n  map(plot_water_insecurity)\n```\n\nData takeaways:  The state of Nuevo León saw a drastic increase in homes experiencing water insecurity from 2021 to 2022. The percentage of homes increased from 7.004% to 42.014% or almost half of the population. Meanwhile, in the state of Tabasco, the percentage of homes dealing with water insecurity dropped from 38.690% to 10.830%.\n\n\n## Groundwater \n\nNow I will look at the volume of available groundwater that can be used by each population in a way that will not hurt the environment. \n\nThe data for this variable only accounts for information from 2018 and 2020. \n\nHere I prepared the data: \n\n```{r}\ngroundwater_volume <- all_the_data |>\n  filter(source == \"groundwater\") |>\n  group_by(unidad_geografica_str, ano) |>\n  select(unidad_geografica_str, valor, ano) |>\n  mutate(ano= str_c(\"01-01-\", ano) |> mdy() )\n\n\ngroundwater_volume\n```\n\nNow I will visualize the data by building a function specific to ground water data: \n\n```{r}\ngroundwater_list <- all_the_data |> distinct(unidad_geografica_str) |> pull(unidad_geografica_str)\n\ngroundwater_list\n```\n\nNow I will plot the data for each state: \n\n```{r}\nplot_groundwater <- function(plot_state) {\n  groundwater_volume |> \n  filter(unidad_geografica_str == plot_state) |>\n  ggplot(aes(x = ano, y = valor, color = unidad_geografica_str)) +\n  geom_point() + \n  geom_col() +\n  labs(title = str_glue(\"Volume of available groundwater in each Mexican state: \", plot_state|> str_to_title()), x= \"Year\", y= \"Value\", color = \"State\", subtitle = str_wrap(\"Many states like Nuevo León are experiencing an increasing deficit of groundwater availablility.\"), caption = \"Source = Consejo Nuevo León\"\n)\n}\n\n## This is an example to make sure that it works: \nplot_groundwater(groundwater_list[[1]])\n```\n\nNow I will plot each state: \n\n```{r}\ngroundwater_list |> \n  map(plot_groundwater)\n```\n\n\nData takeaways: The availability of groundwater in 2018 decreased from -131.490 to -294.150 millions of cubic meters of groundwater, meaning that there is an increase in the deficit volume of groundwater in this state. Nuevo León went through an intense drought in 2022, whose data is not included. \n\n## Reforestation \n\nLastly, I will add the data for the hectares of reforestation done by each state. This data also includes \"Nacional\" or the amount of hectares reforested in the entire nation by year. \n\nI prepare the data: \n\n```{r}\nreforestation_hectares <- all_the_data |>\n  filter(source == \"reforestation\") |>\n  group_by(unidad_geografica_str, ano) |>\n  select(unidad_geografica_str, valor, ano) |>\n  mutate(ano= str_c(\"01-01-\", ano) |> mdy() )\n\nreforestation_hectares\n```\n\nNow I will do my last iteration with this data: \n\n```{r}\nreforestation_list <- all_the_data |> distinct(unidad_geografica_str) |> pull(unidad_geografica_str)\n\nreforestation_list\n```\n\nNow I plot the data with a function: \n\n```{r}\nplot_reforestation <- function(plot_state) {\n  reforestation_hectares |> \n  filter(unidad_geografica_str == plot_state) |>\n  ggplot(aes(x = ano, y = valor, color = unidad_geografica_str)) +\n  geom_point() + \n  geom_line() +\n  labs(title = str_glue(\"Hectares reforested in each Mexican state: \", plot_state|> str_to_title()), x= \"Year\", y= \"Value\", color = \"State\", subtitle = str_wrap(\"At the national level, the most amount of hectares reforested was 375,705.790 in 2012.\"), caption = \"Source = Consejo Nuevo León\"\n)\n}\n\n## This is an example to make sure that it works: \nplot_reforestation(reforestation_list[[1]])\n```\n\nNow I will plot each state: \n\n```{r}\nreforestation_list |> \n  map(plot_reforestation)\n```\n\n\nData takeaway: The national amount of hectares reforested is not surprisingly the entity with the highest amount of hectares. The peak of reforestation happened in 2012, with 375,705.790 hectares reforested in 2012. In 2020, the total amount of hectares reforested dropped to a stunning 4,618.38. \n\n\n\n## Comparing all 32 state rankings \n\nHere I will use a ranking to determine how well each state performed in each category. \n\nStarting with the ranking for the climate change index: \n\n```{r}\n\nclimate_rank <- climate_change_index |>\n  group_by(ano) |>\n  ## Group by year so I could see the ranking by year \n  mutate(ranking = dense_rank(desc(valor))) |>\n## Then created the rank variable in descending order because a higher score is a better score. \n arrange(desc(valor)) |> \n## I wanted to visualize the highest to lowest scores all together \n  add_column(source = \"Climate\")\nclimate_rank\n```\n\nI am using a column graph to show the ranking distribution of each state per year: \n\n```{r}\n climate_rank_chart <- climate_rank |>\n  ggplot(aes(fill = ranking, x= ano |> year() |> as.character(), y= unidad_geografica_str)) +\n  geom_tile() + \n  geom_text(aes(label = ranking), color = \"white\")+\n  labs(\n    x = \"Year\",\n    y = \"State\",\n    title = \"Climate change index ranking by year for each Mexican state\",\n    color = \"Ranking\", \n    subtitle = str_wrap(\"Ciudad de México constantly had the highest ranking for climate change index score. Notably, Mexico City has the highest population density of the country.\"), \n  caption = \"Source = Consejo Nuevo León\"\n  ) +\ntheme(legend.position = \"bottom\")\n\n\n ggsave(\"figures/climate_rank_chart.png\")\n```\n\nNow we print our ranking chart so it looks good on the computer: \n\n![](figures/climate_rank_chart.png)\n\nData takeaway: Ranking each of the 32 federal entities from 1 to 32, we can show that a higher ranking which is associated with a better score performance is represented with a darker blue shade. Aguascalientes and Ciudad de México consistently have a higher ranking per year, while states like Tabasco and Chiapas consistently ranked lower. Ciudad de México is a large urban area, where the data might observe less natural resources. \n\n\nNow I want to look at the water insecurity percentage data and rank each states performance: \n\n```{r}\nwater_insecurity_rank <- water_insecurity_percent |>\n  group_by(ano) |>\n  ## Group by year so I could see the ranking by year \n  mutate(ranking = dense_rank(valor)) |>\n## Then created the rank variable in descending order because a higher score is a better score. \n arrange(valor) |>\n## I wanted to visualize the highest to lowest scores all together \n  add_column(source = \"Water insecurity\")\n\n\nwater_insecurity_rank\n```\n\nNow I want to visualize the ranking: \n\n```{r}\nwater_insecurity_chart <- water_insecurity_rank |>\n  ggplot(aes(fill = ranking, x= ano |> year() |> as.character(), y= unidad_geografica_str)) +\n  geom_tile() +\n  geom_text(aes(label = ranking), color = \"white\") +\n  labs(\n    x = \"Year\",\n    y = \"State\",\n    title = \"Water insecurity performance ranking by year for each Mexican state\",\n    color = \"Ranking\",\n    subtitle = str_wrap(\"Nuevo León had 7.004% of homes with not enough available water in 2021, ranking in fifth place compared to other states. In 2022, the state ranked in last place with 42.014% of homes experiencing water insecurity in 2022.\"), \n    caption = \"Source = Consejo Nuevo León\"\n  ) +\ntheme(legend.position = \"bottom\")\n\n\n ggsave(\"figures/water_insecurity_chart.png\")\n```\n\n![](figures/water_insecurity_chart.png)\n\n\nGroundwater ranking for the states with the most amount of groundwater is represented with this data: \n\n```{r}\ngroundwater_rank <- groundwater_volume |>\n  group_by(ano) |>\n  ## Group by year so I could see the ranking by year \n  mutate(ranking = dense_rank(desc(valor))) |>\n## Then created the rank variable in descending order because a higher score is a better score. \n arrange(desc(valor)) |> \n## I wanted to visualize the highest to lowest scores all together \n   add_column(source = \"Groundwater\")\n \n\ngroundwater_rank\n```\n\n\nNow we will visualize the groundwater ranking: \n\n```{r}\ngroundwater_chart <- groundwater_rank |>\n  ggplot(aes(fill = ranking, x= ano |> year() |> as.character(), y= unidad_geografica_str)) +\n  geom_tile() +\n  geom_text(aes(label = ranking), color= \"white\") +\n  labs(\n    x = \"Year\",\n    y = \"State\",\n    title = \"Amount of available groundwater volume for each Mexican state\",\n    color = \"Ranking\", \n    subtitle = str_wrap(\"Nuevo León has a significant deficit of groundwater availablility, with -294.150 millions of cubic meters of groundwater.\"), \n    caption = \"Source = Consejo Nuevo León\"\n  ) +\ntheme(legend.position = \"bottom\")\n\n\n ggsave(\"figures/groundwater_chart.png\") \n```\n\n\n![](figures/groundwater_chart.png)\n\nFinally, lets look at the ranking for reforestation efforts in each state: \n\n```{r}\nreforestation_rank <- reforestation_hectares |> \n  filter(unidad_geografica_str != \"Nacional\") |>\n  group_by(ano) |>\n  ## Group by year so I could see the ranking by year \n  mutate(ranking = dense_rank(desc(valor))) |>\n## Then created the rank variable in descending order because a higher score is a better score. \n arrange(desc(valor)) |> \n## I wanted to visualize the highest to lowest scores all together \n  add_column(source = \"Reforestation\")\n\n\nreforestation_rank\n```\n\n\nNow I will visualize the data using ggplot: \n\n```{r}\nreforestation_chart <- reforestation_rank |>\n  ggplot(aes(fill = ranking, x= ano |> year() |> as.character(), y= unidad_geografica_str)) +\n  geom_tile() +\n  geom_text(aes(label = ranking), color = \"white\") + \n  labs(\n    x = \"Year\",\n    y = \"State\",\n    title = \"Hectares reforested in each Mexican state\",\n    color = \"Ranking\", \n    subtitle = str_wrap(\"Hectares of reforested areas in each state vary consistently. The year 2012 had a significant increase in reforested areas, with states like San Luis Potosi and Coahuila leading in rank.\"), \n   caption = \"Source = Consejo Nuevo León\"\n  ) +\ntheme(legend.position = \"bottom\")\n\n\n ggsave(\"figures/reforestation_chart.png\") \n```\n\n![](figures/reforestation_chart.png)\n\n## Nuevo León ranking \n\nIn order to see how my home state of Nuevo León did in all of the categories I have to put the ranking data together: \n\nI will combine the ranking using bind.rows: \n\n\n```{r}\nnuevo_leon_ranking <- \nbind_rows(climate_rank, water_insecurity_rank, groundwater_rank, reforestation_rank) |> \n  filter(unidad_geografica_str == \"Nuevo León\")\n\nnuevo_leon_ranking\n## We added the source column in each ranking break down \n```\n\n\nVisualize the ranking for Nuevo León: \n\n```{r}\nnuevo_leon_ranking  |>\n  ggplot(aes(fill = ranking, x= ano |> year() |> as.character(), y= source)) +\n   geom_tile()+\n   geom_text(aes(label = ranking), color = \"white\") +\n  labs(\n    x = \"Year\",\n    y = \"Category\",\n    title = \"Nuevo León ranking in all four categories\",\n    color = \"Ranking\", \n    subtitle = str_wrap(\"Each tile represents the ranking position of the state of Nuevo León for the four different categories: climate change index, water insecurity, groundwater and reforestation. Even though Nuevo León placed 33rd in 2022 for water insecurity, which is the lowest ranking position, the state ranked fourth in the same year for climate change index.\"), \n    caption = \"Source = Consejo Nuevo León\"\n  ) +\ntheme(legend.position = \"bottom\")\n\n\n ggsave(\"figures/nuevo_leon_ranking.png\") \n```\n\n![](figures/nuevo_leon_ranking.png)\n\n\nData takeaways: Each tile represents the ranking position of the state of Nuevo León for the four different categories: climate change index, water insecurity, groundwater and reforestation. Even though Nuevo León placed thirty third in 2022 for water insecurity (including the ranking for the whole nation plus 32 federal entities), which is the lowest ranking, the state ranked fourth in the same year for climate change index, or how well the state uses its natural resources. Extra reporting and investigation would be needed to asses these contrasting results.  \n\nFor the category of reforestation, Nuevo León has significantly improved when compared to other states. In 1993, Nuevo León occupied 16th place, but moved up to fourth in 2022. \n\n\n\n\n\n\n\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"02-analysis.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.4.549","theme":"cosmo","title":"Analysis"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}